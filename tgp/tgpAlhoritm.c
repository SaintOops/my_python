#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define individuals 10
#define trees 4
#define maxDepth 30

typedef struct node {
	char* op;
	int rt;
	struct node* left;
	struct node* right;
	struct node_values* pa;
} list_node;

typedef struct node_values {
	double values;
} list_node_values;

// функция для подсчёта количества уровней в дереве
int depth(list_node* root, int pp);

// функция для подсчёта количества операторов в дереве
int countOper(list_node* root);

// функция для добавления нового элемента в дерево
list_node* add_end(list_node* sheet, char* op, int add);

// функция для создания дерева
list_node* tree_creation(char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62]);

// функция для проверки является ли rr опертором
int in_massiv(char* rr);

// функция для вычисления значения кусочка дерева
double count(list_node* current, double a, double b);

// функция для вычисления всего дерева
double counting(list_node* root, char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], double featuresDoubl[62]);

// фитнесс функция
double fitnessFunction(list_node* func[trees], double const_list[26], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], double a, double b);

// макромутация
void macroMutation(list_node* func[individuals][trees], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], int probability);

// микромутация
void microMutation(list_node* func[individuals][trees], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], int probability, int maxLevel);

//кроссовер
void crossover(list_node* func_1[trees], list_node* func_2[trees]);

//репродукция
void reproduction(list_node* func[individuals][trees], double fitness_values[individuals]);

int main() {
	srand(time(NULL));

	char* operators[4] = { "+", "-", "*", "/" };

	//	char* operatorsFeaturesChar[16] = { "+", "-", "*", "/" , "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11" };
	//	double const_list[4] = { 9., 10., 11., 12. };
	//	char* featuresChar[12] = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11" };
	//	double featuresDoubl[12] = { 1., 2., 3., 4., 5., 6., 7., 8., 9., 10., 11., 12. };

	char* operatorsFeaturesChar[66] = { "+", "-", "*", "/" , "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26",\
	"27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57",\
	"58", "59", "60", "61" };
	char* featuresChar[62] = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26",\
	"27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57",\
	"58", "59", "60", "61"};
	double const_list[26] = { 0.167871, 0.89581, 0.704043, 0.95226, 0.877122, 0.220877, 0.157614, 
		0.700679, 0.548782, 0.476945, 0.855171, 0.915302, 0.357721, 0.819682, 
		0.0109201, 0.347089, 0.107229, 0.0426012, 0.847493, 0.184294, 
		0.490645, 0.678793, 0.118587, 0.804378, 0.875388, 0.743938 };
	double featuresDoubl[62] = { 0.167871, 0.89581, 0.704043, 0.95226, 0.877122, 0.220877, 0.157614, 
		0.700679, 0.548782, 0.476945, 0.855171, 0.915302, 0.357721, 0.819682, 
		0.0109201, 0.347089, 0.107229, 0.0426012, 0.847493, 0.184294, 
		0.490645, 0.678793, 0.118587, 0.804378, 0.875388, 0.743938,
		1., 0.990124, 0.910496, 0.278389, 0.820992, 0.820992, 0.910496,
		0.179008, 0.731488, 0.0993805, 0.0993805, 0.188884, 0.169132,
		0.019753, 0.089504, 0.089504, 0.188884, 0.920372, 0.00987648,
		0.00987648, 0.731488, 0.0993805, 0.188884, 0.910496, 0.820992,
		0.731488, 0.0993805, 0.019753, 0.089504, 0.820992, 0.990124,
		0.910496, 0.278388, 0.179008, 0.731488, 0.188884 };
	double fitness_values[individuals];
	list_node* func[individuals][trees];
	double a = 1.15;
	double b = 0.15;
	int probability = 50;
	int maxLevel = 30;


	for (int j = 0; j < individuals; j++) {
		for (int i = 0; i < trees; i++) {
			func[j][i] = tree_creation(operators, operatorsFeaturesChar, featuresChar);
		}
	}

	for (int ko = 0; ko < 50; ko++) {

		for (int i = 0; i < individuals; i++) {
			fitness_values[i] = fitnessFunction(func[i], const_list, operators, operatorsFeaturesChar, featuresChar, a, b);
		}

		reproduction(func, fitness_values);

		crossover(func, func);

		macroMutation(func, operators, operatorsFeaturesChar, featuresChar, probability);

		microMutation(func, operators, operatorsFeaturesChar, featuresChar, probability, maxLevel);


	}

	for (int i = 0; i < individuals; i++) {
		double fgh = fitnessFunction(func[i], const_list, operators, operatorsFeaturesChar, featuresChar, a, b);
		printf("%f\n", fgh);
	}

	return 0;
}


void reproduction(list_node* func[individuals][trees], double fitness_values[individuals]) {
	for (int i = 0; i < individuals-1; i++) {
		for (int j = individuals - 1; j > i; j--) {
			if (fitness_values[j - 1] > fitness_values[j]) {
				int temp = fitness_values[j - 1];
				fitness_values[j - 1] = fitness_values[j];
				fitness_values[j] = temp;

				for (int k = 0; k < trees; k++) {
					list_node* aaa = func[j][k];
					list_node* bbb = func[j - 1][k];
					func[j][k] = bbb;
					func[j - 1][k] = aaa;
				}
			}
		}
	}

	
	for (int i = individuals / 2; i < individuals; i++) {
		for (int j = 0; j < trees; j++) {
			func[i][j] = func[i - individuals / 2][j];
		}
	}
	
}

void crossover(list_node* func_1[individuals][trees], list_node* func_2[individuals][trees]) {
	int posis[individuals / 2][2];
	for (int i = 0; i < individuals / 2; i++) {
		posis[i][0] = rand() % individuals;
		posis[i][1] = rand() % individuals;
	}
	for (int i = 0; i < individuals / 2; i++) {
		int a = rand() % trees;
		int b = rand() % trees;
		for (int j = 0; j < trees; j++) {
			list_node* c = func_1[posis[i][0]][a];
			func_1[posis[i][0]][a] = func_2[posis[i][1]][b];
			func_2[posis[i][1]][b] = c;
		}
	}
}

void microMutation(list_node* func[individuals][trees], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], int probability, int maxLevel) {
	for (int i = 0; i < individuals/2; i++) {
		int ghh = rand() % 100;
		if (ghh < probability) {
			int hjj = rand() % trees;

			int pp = depth(func[i][hjj], maxDepth);
			if (pp < maxLevel - 5) {
				list_node** links;
				links = (list_node*)malloc(pp * sizeof(list_node));
				links[0] = func[i][hjj];
				list_node* current = func[i][hjj];
				int k = countOper(func[i][hjj]);
				int hp = (rand() % k) + 1;
				int pl = 1;
				int n = 0;
				if (hp == 1) {
					func[i][hjj] = tree_creation(operators, operatorsFeaturesChar, featuresChar);
				}
				else {
					if (func[i][hjj]->rt == 1) {
						while (func[i][hjj]->rt != 0) {
							if (in_massiv(current->left->op) && current->left->rt != 0) {
								pl++;
								if (pl == hp) {
									current->left = tree_creation(operators, operatorsFeaturesChar, featuresChar);
									break;
								}
								n++;
								links[n] = current->left;
								current = current->left;
							}

							else if (in_massiv(current->right->op) && current->right->rt != 0) {
								pl++;
								if (pl == hp) {
									current->right = tree_creation(operators, operatorsFeaturesChar, featuresChar);
									break;
								}
								n++;
								links[n] = current->right;
								current = current->right;
							}

							else if (current->left->rt == 0 && current->right->rt == 0) {
								current->rt = 0;
								n--;
								current = links[n];
							}

							else if (current->left->rt == 0 && !in_massiv(current->right->op)) {
								current->rt = 0;
								current->right->rt = 0;
								current = links[n - 1];
								n--;
							}

							else if (!in_massiv(current->left->op) && current->right->rt == 0) {
								current->rt = 0;
								current->left->rt = 0;
								current = links[n - 1];
								n--;
							}

							else {
								current->rt = 0;
								current->left->rt = 0;
								current->right->rt = 0;
								current = links[n - 1];
								n--;

							}

						}
					}
					else {
						while (func[i][hjj]->rt != 1) {
							if (in_massiv(current->left->op) && current->left->rt != 1) {
								pl++;
								if (pl == hp) {
									current->left = tree_creation(operators, operatorsFeaturesChar, featuresChar);
									break;
								}
								n++;
								links[n] = current->left;
								current = current->left;
							}

							else if (in_massiv(current->right->op) && current->right->rt != 1) {
								pl++;
								if (pl == hp) {
									current->right = tree_creation(operators, operatorsFeaturesChar, featuresChar);
									break;
								}
								n++;
								links[n] = current->right;
								current = current->right;
							}

							else if (current->left->rt == 1 && current->right->rt == 1) {
								current->rt = 1;
								n--;
								current = links[n];
							}

							else if (current->left->rt == 1 && !in_massiv(current->right->op)) {
								current->rt = 1;
								current->right->rt = 1;
								current = links[n - 1];
								n--;
							}

							else if (!in_massiv(current->left->op) && current->right->rt == 1) {
								current->rt = 1;
								current->left->rt = 1;
								current = links[n - 1];
								n--;
							}

							else {
								current->rt = 1;
								current->left->rt = 1;
								current->right->rt = 1;
								current = links[n - 1];
								n--;

							}

						}

					}
				}

			}
		}
	}

}



double fitnessFunction(list_node* func[trees], double const_list[26], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], double a, double b) {
	double featureList[26][5][36] = { {{1., 0.990124, 0.910496, 0.278389, 0.820992, 0.820992, 0.910496,
   0.179008, 0.731488, 0.0993805, 0.0993805, 0.188884, 0.169132,
   0.019753, 0.089504, 0.089504, 0.188884, 0.920372, 0.00987648,
   0.00987648, 0.731488, 0.0993805, 0.188884, 0.910496, 0.820992,
   0.731488, 0.0993805, 0.019753, 0.089504, 0.820992, 0.990124,
   0.910496, 0.278388, 0.179008, 0.731488, 0.188884}, {1., 1., 1.,
   0.75, 0.75, 0.75, 1., 0.25, 0.25, 0., 0., 0., 0., 0., 0., 0., 0.25,
	1., 0., 0., 0.75, 0., 0.25, 1., 0.75, 0.25, 0., 0., 0., 0.75, 1.,
   1., 0.75, 0.25, 0.25, 0.}, {1., 0.903542, 0.889762, 0.385833,
   0.845667, 0.845667, 0.889762, 0.154333, 0.742778, 0.128611,
   0.128611, 0.192917, 0.128611, 0.110238, 0.110238, 0.110238,
   0.192917, 0.903542, 0.0964583, 0.0964583, 0.742778, 0.128611,
   0.192917, 0.889762, 0.845667, 0.742778, 0.128611, 0.110238,
   0.110238, 0.845667, 0.903542, 0.889762, 0.385833, 0.154333,
   0.742778, 0.192917}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0.,
   1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0.,
	0., 1., 1., 1., 1., 0., 0., 1.}, {1., 1., 1., 1., 1., 1., 1., 0.,
   0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 1., 1., 1.,
	0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 1.}}, {{0.910496,
   0.920372, 0.198761, 0.198761, 0.198761, 0.920372, 0.65186,
   0.0993805, 0.0993805, 0.0993805, 0.0993805, 0.830868, 0.159255,
   0.801239, 0., 0.721611, 0.721611, 0.0993805, 0.169132, 0.169132,
   0., 0.890743, 0.169132, 0.811116, 0.0993805, 0.179008, 0.169132,
   0.089504, 0.0993805, 0.980247, 0.34814, 0.34814, 0.910496,
   0.731488, 0.258636, 1.}, {1., 1., 0.5, 0.5, 0.5, 1., 0.25, 0., 0.,
   0., 0., 1., 0., 0.25, 0., 0.25, 0.25, 0., 0., 0., 0., 1., 0., 0.25,
	0., 0.25, 0., 0., 0., 1., 0.75, 0.75, 1., 0.25, 0.25,
   1.}, {0.885556, 0.899861, 0.267037, 0.267037, 0.267037, 0.899861,
   0.599444, 0.133519, 0.133519, 0.133519, 0.133519, 0.866481,
   0.114444, 0.732963, 0., 0.599444, 0.599444, 0.133519, 0.133519,
   0.133519, 0., 0.839778, 0.133519, 0.799722, 0.133519, 0.160222,
   0.133519, 0.114444, 0.133519, 0.885556, 0.400556, 0.400556,
   0.885556, 0.732963, 0.200278, 1.}, {1., 1., 1., 1., 1., 1., 0., 0.,
	0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
   0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 1., 1.}, {1., 1., 1., 1.,
   1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
	1., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 1.,
   1.}}, {{1., 0.840745, 0.268512, 0.268512, 0.840745, 1., 0.920372,
   0.671613, 0.0993805, 0.0993805, 0.671613, 0.840745, 0.751241,
   0.0993805, 0.268512, 0.268512, 0.0993805, 0.741364, 0.0993805,
   0.731488, 0.910496, 1., 0.0993805, 0.801239, 0.0993805, 0.801239,
   0.90062, 1., 0.179008, 0.890743, 0.90062, 0.970371, 0.990124, 1.,
   0.990124, 0.990124}, {1., 1., 0.75, 0.75, 1., 1., 1., 0.25, 0., 0.,
	0.25, 1., 0.75, 0., 0.25, 0.25, 0., 0.5, 0., 0.25, 1., 1., 0.,
   0.5, 0., 0.5, 1., 1., 0., 1., 1., 1., 1., 1., 1., 1.}, {1.,
   0.906746, 0.217593, 0.217593, 0.906746, 1., 0.918403, 0.836806,
   0.108796, 0.108796, 0.836806, 0.906746, 0.869444, 0.108796,
   0.217593, 0.217593, 0.108796, 0.836806, 0.108796, 0.782407,
   0.906746, 1., 0.108796, 0.782407, 0.108796, 0.782407, 0.891204, 1.,
	0.130556, 0.869444, 0.891204, 0.891204, 0.918403, 1., 0.918403,
   0.918403}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 0.,
	1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 1., 1., 0., 1.,
   1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0.,
   0., 1., 1., 0., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 1.,
	1., 0., 1., 1., 1., 1., 1., 1., 1.}}, {{0.990124, 0.90062,
   0.90062, 0.90062, 0.90062, 0.910496, 0.970371, 0.801239, 0.801239,
   0.801239, 0.801239, 0.820992, 0.801239, 0.00987648, 0.019753,
   0.089504, 0.0796275, 0.0993805, 0.811116, 0.089504, 0.179008,
   0.089504, 0.801239, 0.0993805, 0.338263, 0.159255, 0.159255,
   0.159255, 0.159255, 0.741364, 0.990124, 0.258636, 0.661737,
   0.0993805, 0.0993805, 0.990124}, {1., 1., 1., 1., 1., 1., 1., 0.5,
   0.5, 0.5, 0.5, 0.75, 0.5, 0., 0., 0., 0., 0., 0.75, 0., 0.25, 0.,
   0.5, 0., 0.75, 0., 0., 0.25, 0., 0.25, 1., 0.25, 0.25, 0., 0.,
   1.}, {0.903889, 0.871852, 0.871852, 0.871852, 0.871852, 0.890159,
   0.871852, 0.743704, 0.743704, 0.743704, 0.743704, 0.846222,
   0.743704, 0.0961111, 0.109841, 0.109841, 0.0961111, 0.128148,
   0.807778, 0.109841, 0.153778, 0.109841, 0.743704, 0.128148,
   0.256296, 0.109841, 0.109841, 0.109841, 0.109841, 0.807778,
   0.903889, 0.192222, 0.743704, 0.128148, 0.128148, 0.903889}, {1.,
   1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
	0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0.,
   0., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 0., 0.,
   0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1.,
	1., 0., 0., 0., 1.}}, {{0.990124, 0.990124, 0.990124, 0.90062,
   0.90062, 0.90062, 0.970371, 0.169132, 0.169132, 0.801239, 0.801239,
	0.801239, 0.169132, 0.801239, 0.169132, 0.089504, 0.089504,
   0.00987648, 0.0993805, 0.801239, 0.0993805, 0.0993805, 0.90062,
   0.0993805, 0.188884, 0.90062, 0.910496, 0.188884, 0.188884,
   0.0993805, 1., 1., 1., 0.358016, 0.920372, 0.910496}, {1., 1., 1.,
   1., 1., 1., 1., 0., 0., 0.5, 0.5, 0.5, 0., 0.25, 0.25, 0., 0., 0.,
   0., 0.5, 0., 0., 1., 0., 0., 1., 1., 0., 0.25, 0., 1., 1., 1.,
   0.75, 1., 1.}, {0.901667, 0.901667, 0.901667, 0.868889, 0.868889,
   0.868889, 0.868889, 0.131111, 0.131111, 0.737778, 0.737778,
   0.737778, 0.131111, 0.737778, 0.131111, 0.112381, 0.112381,
   0.0983333, 0.131111, 0.737778, 0.131111, 0.131111, 0.868889,
   0.131111, 0.196667, 0.868889, 0.887619, 0.196667, 0.196667,
   0.131111, 1., 1., 1., 0.786667, 0.901667, 0.887619}, {1., 1., 1.,
   1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
	0., 0., 1., 0., 1., 1., 1., 1., 1., 0., 1., 1., 1., 1., 1.,
   1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
   0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1., 1., 1., 0., 1., 1.,
	1., 1., 1., 1.}}, {{0.990124, 0.990124, 0.990124, 0.90062,
   0.90062, 0.90062, 0.970371, 0.169132, 0.169132, 0.801239, 0.801239,
	0.801239, 0.169132, 0.801239, 0.169132, 0.089504, 0.721611,
   0.089504, 0.0993805, 0.801239, 0.0993805, 0.0993805, 0.811116,
   0.910496, 0.188884, 0.90062, 0.910496, 0.188884, 0.910496, 1., 1.,
   1., 1., 0.358016, 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0.,
   0.5, 0.5, 0.5, 0., 0.25, 0.25, 0., 0.25, 0., 0., 0.5, 0., 0., 0.75,
	1., 0., 1., 1., 0., 1., 1., 1., 1., 1., 0.75, 1., 1.}, {0.9225,
   0.9225, 0.9225, 0.896667, 0.896667, 0.896667, 0.896667, 0.103333,
   0.103333, 0.793333, 0.793333, 0.793333, 0.103333, 0.793333,
   0.103333, 0.0885714, 0.69, 0.0885714, 0.103333, 0.793333, 0.103333,
	0.103333, 0.845, 0.911429, 0.155, 0.896667, 0.911429, 0.155,
   0.911429, 1., 1., 1., 1., 0.62, 1., 1.}, {1., 1., 1., 1., 1., 1.,
   1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
	1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.}, {1., 1., 1.,
   1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
	0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
   1.}}, {{0.990124, 0.338263, 0.90062, 0.830868, 0.268512, 0.990124,
   0.970371, 0.169132, 0.019753, 0.0993805, 0.169132, 0.970371,
   0.169132, 0.731488, 0.0993805, 0.179008, 0.811116, 0.169132,
   0.0993805, 0.801239, 0.801239, 0.0993805, 0.90062, 0.0993805,
   0.188884, 0.820992, 0.820992, 0.019753, 0.089504, 0.179008,
   0.920372, 0.920372, 1., 0.820992, 0.731488, 0.910496}, {1., 0.75,
   1., 1., 0.75, 1., 1., 0.25, 0., 0., 0., 1., 0., 0.25, 0.25, 0., 1.,
	0., 0., 0.5, 0.5, 0., 1., 0., 0., 0.75, 0.75, 0., 0., 0., 1., 1.,
   1., 0.75, 0.25, 1.}, {0.907153, 0.247593, 0.876204, 0.876204,
   0.247593, 0.907153, 0.876204, 0.123796, 0.106111, 0.123796,
   0.123796, 0.876204, 0.123796, 0.752407, 0.123796, 0.148556,
   0.814306, 0.123796, 0.123796, 0.752407, 0.752407, 0.123796,
   0.876204, 0.123796, 0.185694, 0.851444, 0.851444, 0.106111,
   0.106111, 0.148556, 0.907153, 0.907153, 1., 0.851444, 0.752407,
   0.893889}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 0., 0.,
	0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1., 0., 0., 0.,
   1., 1., 1., 1., 0., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0.,
   0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1.,
	0., 0., 0., 1., 1., 1., 1., 0., 1.}}, {{0.920372, 0.920372,
   0.990124, 0.258636, 0.90062, 0.90062, 0.188884, 0.0993805,
   0.0993805, 0.00987648, 0.089504, 0.0993805, 0.910496, 0.90062,
   0.268512, 0.0993805, 0.820992, 0.278389, 0.920372, 0.198761,
   0.278389, 0.0993805, 0.890743, 0.90062, 0.188884, 0.0993805,
   0.0993805, 0.019753, 0.179008, 0.0993805, 0.910496, 0.90062,
   0.90062, 0.910496, 1., 1.}, {1., 1., 1., 0.75, 1., 1., 0., 0., 0.,
   0., 0., 0., 1., 1., 0.25, 0., 0.75, 0.75, 1., 0.5, 0.75, 0., 1.,
   1., 0., 0., 0., 0., 0.25, 0., 1., 1., 1., 1., 1., 1.}, {0.916042,
   0.916042, 0.916042, 0.167917, 0.888056, 0.888056, 0.167917,
   0.111944, 0.111944, 0.0839583, 0.0959524, 0.111944, 0.904048,
   0.888056, 0.223889, 0.111944, 0.865667, 0.335833, 0.916042,
   0.223889, 0.335833, 0.111944, 0.865667, 0.888056, 0.167917,
   0.111944, 0.111944, 0.0959524, 0.134333, 0.111944, 0.904048,
   0.888056, 0.888056, 0.904048, 1., 1.}, {1., 1., 1., 1., 1., 1., 1.,
	0., 0., 0., 0., 0., 1., 1., 1., 0., 1., 1., 1., 1., 1., 0., 1.,
   1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 1.}, {1., 1., 1.,
   1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 1., 1., 1., 1.,
	1., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1.,
   1.}}, {{0.990124, 0.990124, 1., 1., 1., 1., 0.980247, 0.890743,
   0.90062, 0.90062, 0.90062, 0.188884, 0.890743, 0.0796275, 0.801239,
	0.721611, 0.721611, 0.0993805, 0.890743, 0.00987648, 0.0993805,
   0.089504, 0.0796275, 0.0993805, 0.910496, 0.109257, 0.278389,
   0.990124, 0.90062, 0.188884, 1., 1., 1., 1., 1., 1.}, {1., 1., 1.,
   1., 1., 1., 1., 1., 1., 1., 1., 0., 1., 0., 0.5, 0.25, 0.25, 0.,
   1., 0., 0., 0., 0., 0., 1., 0., 0.75, 1., 1., 0., 1., 1., 1., 1.,
   1., 1.}, {0.936181, 0.936181, 1., 1., 1., 1., 0.927063, 0.897889,
   0.914907, 0.914907, 0.914907, 0.127639, 0.897889, 0.0638194,
   0.829815, 0.744722, 0.744722, 0.0850926, 0.897889, 0.0638194,
   0.0850926, 0.0729365, 0.0638194, 0.0850926, 0.927063, 0.102111,
   0.255278, 0.936181, 0.914907, 0.127639, 1., 1., 1., 1., 1.,
   1.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0.,
   0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1., 1., 1., 1.,
	1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
   1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1.,
	1., 1., 1., 1., 1., 1., 1.}}, {{0.990124, 0.990124, 1., 0.990124,
   0.248759, 0.258636, 0.980247, 0.890743, 0.90062, 0.890743,
   0.731488, 0.019753, 0.890743, 0.0796275, 0.801239, 0.801239,
   0.731488, 0.0993805, 0.811116, 0.00987648, 0.0993805, 0.0993805,
   0.0993805, 0.751241, 0.910496, 0.188884, 0.920372, 0.198761,
   0.198761, 0.840745, 1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1., 0.75,
	0.75, 1., 1., 1., 1., 0.25, 0., 1., 0., 0.5, 0.5, 0.25, 0., 0.75,
   0., 0., 0., 0., 0.25, 1., 0., 1., 0.5, 0.5, 1., 1., 1., 1., 1., 1.,
	1.}, {0.927708, 0.927708, 1., 0.927708, 0.115667, 0.144583,
   0.917381, 0.884333, 0.903611, 0.884333, 0.807222, 0.082619,
   0.884333, 0.0722917, 0.807222, 0.807222, 0.807222, 0.0963889,
   0.855417, 0.0722917, 0.0963889, 0.0963889, 0.0963889, 0.884333,
   0.917381, 0.144583, 0.927708, 0.192778, 0.192778, 0.917381, 1., 1.,
	1., 1., 1., 1.}, {1., 1., 1., 1., 0., 1., 1., 1., 1., 1., 0., 0.,
   1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 1.,
	1., 1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1., 0., 1., 1., 1., 1.,
   1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1.,
	1., 1., 1., 1., 1., 1., 1., 1., 1., 1.}}, {{1., 0.910496, 0.90062,
	0.90062, 0.90062, 0.910496, 0.990124, 0.811116, 0.801239,
   0.801239, 0.801239, 0.811116, 0.990124, 0.169132, 0.0796275, 0.,
   0.00987648, 0.019753, 0.990124, 0.328387, 0.159255, 0.169132,
   0.0993805, 0.741364, 0.34814, 0.169132, 0.169132, 0.910496,
   0.741364, 0.169132, 1., 0.830868, 0.910496, 1., 0.910496,
   0.109257}, {1., 1., 1., 1., 1., 1., 1., 0.75, 0.5, 0.5, 0.5, 0.75,
   1., 0., 0., 0., 0., 0., 1., 0.75, 0., 0., 0., 0.5, 0.75, 0., 0.,
   1., 0.25, 0., 1., 1., 1., 1., 1., 0.}, {1., 0.909841, 0.894815,
   0.894815, 0.894815, 0.909841, 0.921111, 0.842222, 0.78963, 0.78963,
	0.78963, 0.842222, 0.921111, 0.105185, 0.0788889, 0., 0.0788889,
   0.0901587, 0.921111, 0.157778, 0.0901587, 0.105185, 0.105185,
   0.842222, 0.315556, 0.105185, 0.105185, 0.909841, 0.842222,
   0.105185, 1., 0.894815, 0.909841, 1., 0.909841, 0.126222}, {1., 1.,
	1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
   1., 1., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 1., 1., 1., 1., 1.,
	0.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0.,
   0., 0., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 1., 1.,
	1., 1., 1., 0.}}, {{1., 1., 1., 1., 1., 1., 0.990124, 0.830868,
   0.198761, 0.198761, 0.198761, 0.198761, 0.830868, 0.0993805,
   0.0993805, 0.0993805, 0.109257, 0.109257, 0.920372, 0.268512,
   0.90062, 0.90062, 0.188884, 0.0993805, 1., 1., 1., 1., 0.198761,
   0.0993805, 1., 1., 1., 1., 0.920372, 0.188884}, {1., 1., 1., 1.,
   1., 1., 1., 1., 0.5, 0.5, 0.5, 0.5, 0.75, 0., 0., 0., 0., 0., 1.,
   0.75, 1., 1., 0.25, 0., 1., 1., 1., 1., 0.5, 0., 1., 1., 1., 1.,
   1., 0.}, {1., 1., 1., 1., 1., 1., 0.923958, 0.898611, 0.202778,
   0.202778, 0.202778, 0.202778, 0.898611, 0.101389, 0.101389,
   0.101389, 0.121667, 0.121667, 0.923958, 0.202778, 0.898611,
   0.898611, 0.152083, 0.101389, 1., 1., 1., 1., 0.202778, 0.101389,
   1., 1., 1., 1., 0.923958, 0.152083}, {1., 1., 1., 1., 1., 1., 1.,
   1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 0.,
	1., 1., 1., 1., 1., 0., 1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1.,
   1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1.,
	1., 1., 0., 1., 1., 1., 1., 1., 0., 1., 1., 1., 1., 1.,
   1.}}, {{0.990124, 0.910496, 0.920372, 0.268512, 0.890743, 0.820992,
	0.980247, 0.731488, 0.0993805, 0.089504, 0.089504, 0.188884,
   0.910496, 0.089504, 0.0796275, 0.811116, 0.268512, 0.920372,
   0.920372, 0.258636, 0.0796275, 0.169132, 0.34814, 1., 0.910496,
   0.089504, 0.169132, 0.328387, 0.890743, 0.990124, 0.990124,
   0.179008, 0.0993805, 0.169132, 0.801239, 0.90062}, {1., 1., 1.,
   0.75, 1., 0.75, 1., 0.25, 0., 0., 0., 0., 1., 0., 0., 0.75, 0.75,
   1., 1., 0.5, 0., 0., 0.75, 1., 1., 0., 0., 0.75, 1., 1., 1., 0.,
   0., 0., 0.5, 1.}, {0.900417, 0.88619, 0.900417, 0.265556, 0.840667,
	0.840667, 0.88619, 0.734444, 0.132778, 0.11381, 0.11381, 0.199167,
	0.88619, 0.11381, 0.0995833, 0.800833, 0.265556, 0.900417,
   0.900417, 0.199167, 0.0995833, 0.132778, 0.398333, 1., 0.88619,
   0.11381, 0.132778, 0.199167, 0.840667, 0.900417, 0.900417,
   0.159333, 0.132778, 0.132778, 0.734444, 0.867222}, {1., 1., 1., 1.,
	1., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 1., 1.,
   0., 0., 1., 1., 1., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0.,
   1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0.,
   0., 1., 1., 1., 1., 0., 0., 1., 1., 1., 0., 0., 1., 1., 1., 1., 0.,
	0., 0., 0., 1.}}, {{0.278389, 0.198761, 0.268512, 0.890743,
   0.811116, 0.990124, 0.188884, 0.0993805, 0.169132, 0.089504,
   0.0993805, 0.830868, 0.820992, 0.159255, 0.159255, 0.179008,
   0.198761, 1., 0.188884, 0.169132, 0.721611, 0.089504, 0.751241,
   0.920372, 0.0993805, 0.0993805, 0.0993805, 0.179008, 0.109257,
   0.840745, 0.820992, 0.910496, 0.198761, 0.198761, 0.278389,
   1.}, {0.75, 0.5, 0.75, 1., 0.75, 1., 0., 0., 0.25, 0., 0., 0.75,
   0.75, 0., 0., 0.25, 0.75, 1., 0., 0.25, 0.25, 0., 0.75, 1., 0., 0.,
	0., 0.25, 0., 1., 0.75, 1., 0.5, 0.5, 0.75, 1.}, {0.374722,
   0.249815, 0.249815, 0.850111, 0.812639, 0.906319, 0.187361,
   0.124907, 0.124907, 0.107063, 0.124907, 0.875093, 0.850111,
   0.107063, 0.107063, 0.149889, 0.249815, 1., 0.187361, 0.124907,
   0.625278, 0.107063, 0.850111, 0.906319, 0.124907, 0.124907,
   0.124907, 0.149889, 0.149889, 0.892936, 0.850111, 0.892936,
   0.249815, 0.249815, 0.374722, 1.}, {1., 1., 1., 1., 0., 1., 1., 0.,
	0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 1., 1.,
   0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1.,
   0., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 1., 0., 0.,
	0., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 1.,
   1.}}, {{1., 0.840745, 0.830868, 0.90062, 0.338263, 0.990124, 1.,
   0.109257, 0.0993805, 0.0993805, 0.089504, 0.820992, 0.820992,
   0.0993805, 0.268512, 0.198761, 0.741364, 0.0993805, 0.801239,
   0.0993805, 0.268512, 0.90062, 0.890743, 0.0993805, 0.970371,
   0.169132, 0.731488, 0.801239, 0.159255, 0.179008, 0.990124,
   0.328387, 0.169132, 0.0993805, 0.661737, 0.910496}, {1., 1., 1.,
   1., 0.75, 1., 1., 0., 0., 0., 0., 1., 0.75, 0., 0.75, 0.5, 0.25,
   0., 0.5, 0., 0.75, 1., 1., 0., 1., 0.25, 0.25, 0.5, 0., 0., 1.,
   0.75, 0., 0., 0.25, 1.}, {1., 0.890476, 0.872222, 0.872222,
   0.255556, 0.904167, 1., 0.153333, 0.127778, 0.127778, 0.109524,
   0.846667, 0.846667, 0.127778, 0.255556, 0.255556, 0.808333,
   0.127778, 0.744444, 0.127778, 0.255556, 0.872222, 0.846667,
   0.127778, 0.872222, 0.127778, 0.744444, 0.744444, 0.109524,
   0.153333, 0.904167, 0.191667, 0.127778, 0.127778, 0.744444,
   0.890476}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 0.,
	1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 1., 0., 0., 0., 0., 0.,
   1., 1., 0., 0., 0., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0.,
   0., 1., 1., 0., 1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 1., 0., 0.,
	0., 0., 0., 1., 1., 0., 0., 0., 1.}}, {{0.840745, 0.198761,
   0.198761, 0.198761, 0.198761, 0.278388, 0.0993805, 0.0993805,
   0.0993805, 0.0993805, 0.0993805, 0.188884, 0.089504, 0.179008,
   0.089504, 0.721611, 0.811116, 0.910496, 0.019753, 0.751241,
   0.0993805, 0.801239, 0.90062, 1., 0.671613, 0.109257, 0.0993805,
   0.970371, 0.990124, 1., 0.920372, 0.358016, 0.268512, 0.990124, 1.,
	1.}, {1., 0.5, 0.5, 0.5, 0.5, 0.75, 0., 0., 0., 0., 0., 0., 0.,
   0.25, 0., 0.25, 1., 1., 0., 0.75, 0., 0.5, 1., 1., 0.25, 0., 0.25,
   1., 1., 1., 1., 0.75, 0.25, 1., 1., 1.}, {0.900952, 0.231111,
   0.231111, 0.231111, 0.231111, 0.346667, 0.115556, 0.115556,
   0.115556, 0.115556, 0.115556, 0.173333, 0.0990476, 0.138667,
   0.0990476, 0.653333, 0.826667, 0.900952, 0.0990476, 0.861333,
   0.115556, 0.768889, 0.884444, 1., 0.826667, 0.138667, 0.115556,
   0.884444, 0.913333, 1., 0.913333, 0.693333, 0.231111, 0.913333, 1.,
	1.}, {1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
   0., 0., 1., 0., 1., 0., 0., 1., 1., 0., 0., 0., 1., 1., 1., 1., 1.,
	1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1.,
   0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 1., 1., 0., 0., 0., 1., 1.,
	1., 1., 1., 1., 1., 1., 1.}}, {{1., 0.990124, 0.910496, 0.278388,
   0.920372, 1., 1., 0.258636, 0.169132, 0.0993805, 0.741364,
   0.990124, 0.980247, 0.0993805, 0.731488, 0.801239, 0.159255,
   0.179008, 0.811116, 0.0993805, 0.258636, 0.880867, 0.801239,
   0.0993805, 0.338263, 0.169132, 0.089504, 0.0796275, 0., 0.741364,
   0.990124, 0.338263, 0.811116, 0.801239, 0.731488, 0.0993805}, {1.,
   1., 1., 0.75, 1., 1., 1., 0.75, 0., 0., 0.75, 1., 1., 0., 0.25,
   0.5, 0., 0., 0.75, 0., 0.25, 0.75, 0.75, 0., 0.75, 0.25, 0., 0.,
   0., 0.25, 1., 0.75, 0.75, 0.5, 0.25, 0.}, {1., 0.901458, 0.887381,
   0.394167, 0.901458, 1., 1., 0.197083, 0.131389, 0.131389, 0.802917,
	0.901458, 0.887381, 0.131389, 0.737222, 0.737222, 0.112619,
   0.157667, 0.802917, 0.131389, 0.197083, 0.802917, 0.737222,
   0.131389, 0.262778, 0.131389, 0.112619, 0.0985417, 0., 0.802917,
   0.901458, 0.262778, 0.802917, 0.737222, 0.737222, 0.131389}, {1.,
   1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0.,
	0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0.,
   0., 0.}, {1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 1., 1., 0.,
   0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1.,
	1., 0., 0., 0., 0.}}, {{1., 1., 1., 1., 1., 1., 0.990124, 0.90062,
	0.90062, 0.90062, 0.90062, 0.910496, 0.90062, 0.801239, 0.801239,
   0.801239, 0.801239, 0.820992, 0.0993805, 0.0796275, 0.0796275, 0.,
   0.0796275, 0.179008, 0.169132, 0.159255, 0.159255, 0.089504,
   0.169132, 0.328387, 0.890743, 0.65186, 0.089504, 0.90062, 0.741364,
	0.169132}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
   0.5, 0.5, 0.5, 0.5, 0.75, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
   0.25, 0.75, 1., 0.25, 0., 0.75, 0.25, 0.}, {1., 1., 1., 1., 1., 1.,
	0.917569, 0.890093, 0.890093, 0.890093, 0.890093, 0.905794,
   0.890093, 0.780185, 0.780185, 0.780185, 0.780185, 0.868111,
   0.109907, 0.0824306, 0.0824306, 0., 0.0824306, 0.131889, 0.109907,
   0.0942063, 0.0942063, 0.0942063, 0.109907, 0.164861, 0.868111,
   0.670278, 0.0942063, 0.890093, 0.835139, 0.109907}, {1., 1., 1.,
   1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 0., 0.,
	0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0., 0., 1., 0.,
   0.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0.,
   0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0.,
	0., 1., 0., 0.}}, {{0.920372, 0.278389, 0.840745, 1., 1.,
   0.830868, 0.671613, 0.0993805, 0.0993805, 0.990124, 0.990124,
   0.169132, 0.0993805, 0.169132, 0.159255, 0.820992, 0.910496,
   0.820992, 0.0993805, 0.830868, 0.820992, 0.019753, 0.820992,
   0.188884, 0.0993805, 0.188884, 0.840745, 0.661737, 0.159255,
   0.731488, 0.671613, 0.019753, 0.910496, 0.830868, 0.661737,
   0.089504}, {1., 0.75, 1., 1., 1., 1., 0.25, 0., 0., 1., 1., 0., 0.,
	0.25, 0., 1., 1., 0.75, 0., 0.75, 0.75, 0., 0.75, 0.25, 0., 0.25,
   1., 0.25, 0., 0.25, 0.25, 0., 1., 1., 0.25, 0.}, {0.888889,
   0.531111, 0.848254, 1., 1., 0.822963, 0.734444, 0.177037, 0.177037,
	0.888889, 0.888889, 0.177037, 0.177037, 0.177037, 0.151746,
   0.787556, 0.848254, 0.787556, 0.177037, 0.822963, 0.787556,
   0.151746, 0.787556, 0.265556, 0.177037, 0.265556, 0.848254,
   0.645926, 0.151746, 0.645926, 0.734444, 0.151746, 0.848254,
   0.822963, 0.645926, 0.151746}, {1., 1., 1., 1., 1., 1., 0., 0., 0.,
	1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 1., 1., 0., 1., 1., 0.,
   1., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0.}, {1., 1., 1., 1., 1.,
   1., 0., 0., 0., 1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 1., 1., 0.,
	1., 1., 0., 1., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0.}}, {{1.,
   1., 1., 1., 1., 1., 0.920372, 0.268512, 0.980247, 0.90062, 0.90062,
	0.910496, 0.198761, 0.0993805, 0.801239, 0.801239, 0.801239,
   0.811116, 0.910496, 0.0993805, 0.019753, 0.0993805, 0.0993805,
   0.0993805, 0.910496, 0.188884, 0.920372, 1., 1., 1., 1., 1., 1.,
   1., 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 0.75, 1., 1., 1., 1.,
   0.5, 0., 0.75, 0.5, 0.5, 0.75, 1., 0., 0., 0., 0., 0., 1., 0., 1.,
   1., 1., 1., 1., 1., 1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1.,
   0.946597, 0.142407, 0.938968, 0.928796, 0.928796, 0.938968,
   0.142407, 0.0712037, 0.857592, 0.857592, 0.857592, 0.893194,
   0.938968, 0.0712037, 0.0610318, 0.0712037, 0.0712037, 0.0712037,
   0.938968, 0.106806, 0.946597, 1., 1., 1., 1., 1., 1., 1., 1.,
   1.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0.,
   0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1.,
	1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
   1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 1., 1.,
	1., 1., 1., 1., 1., 1., 1.}}, {{0.990124, 0.90062, 0.90062,
   0.268512, 0.268512, 0.990124, 0.830868, 0.0993805, 0.089504,
   0.089504, 0.169132, 0.338263, 0.920372, 0.198761, 0.268512,
   0.811116, 0.721611, 0.179008, 1., 0.920372, 0.198761, 0.258636,
   0.801239, 0.0993805, 0.830868, 0.0993805, 0.0993805, 0.089504, 0.,
   0.741364, 0.90062, 0.801239, 0.801239, 0.801239, 0.801239,
   0.90062}, {1., 1., 1., 0.75, 0.75, 1., 0.75, 0., 0., 0., 0., 0.75,
   1., 0.5, 0.75, 1., 0.25, 0., 1., 1., 0.5, 0.5, 0.75, 0., 1., 0.,
   0., 0., 0., 0.25, 1., 0.5, 0.5, 0.5, 0.5, 1.}, {0.900625, 0.8675,
   0.8675, 0.265, 0.265, 0.900625, 0.8675, 0.1325, 0.113571, 0.113571,
	0.1325, 0.265, 0.900625, 0.265, 0.265, 0.80125, 0.6025, 0.159, 1.,
	0.900625, 0.265, 0.19875, 0.735, 0.1325, 0.8675, 0.1325, 0.1325,
   0.113571, 0., 0.80125, 0.8675, 0.735, 0.735, 0.735, 0.735,
   0.8675}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 1.,
   1., 0., 0., 0., 1., 1., 1., 1., 0., 0., 1., 0., 0., 0., 0., 0., 1.,
	0., 0., 0., 0., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0.,
   1., 1., 1., 1., 0., 0., 0., 1., 1., 1., 1., 0., 0., 1., 0., 0., 0.,
	0., 0., 1., 0., 0., 0., 0., 1.}}, {{0.90062, 0.089504, 0.820992,
   0.268512, 0.910496, 1., 0.980247, 0.179008, 0.0993805, 0.169132,
   0.741364, 0.840745, 1., 0.920372, 0.258636, 0.721611, 0.089504,
   0.0993805, 1., 1., 0.830868, 0.089504, 0.159255, 0.00987648,
   0.990124, 0.258636, 0.661737, 0.0993805, 0.089504, 0.258636,
   0.328387, 0.159255, 0.159255, 0.258636, 0.830868, 0.990124}, {1.,
   0., 0.75, 0.75, 1., 1., 1., 0., 0., 0., 0.5, 1., 1., 1., 0.5, 0.25,
	0., 0., 1., 1., 1., 0., 0., 0., 1., 0.75, 0.25, 0., 0., 0.25,
   0.75, 0., 0., 0.5, 1., 1.}, {0.877222, 0.105238, 0.852667,
   0.245556, 0.894762, 1., 0.894762, 0.147333, 0.122778, 0.122778,
   0.815833, 0.894762, 1., 0.907917, 0.184167, 0.631667, 0.105238,
   0.122778, 1., 1., 0.877222, 0.105238, 0.105238, 0.0920833,
   0.907917, 0.184167, 0.754444, 0.122778, 0.105238, 0.184167,
   0.184167, 0.105238, 0.105238, 0.184167, 0.877222, 0.907917}, {1.,
   0., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0.,
	1., 1., 1., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 0., 0., 1.,
   1., 1.}, {1., 0., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 1.,
   1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1.,
	0., 0., 1., 1., 1.}}, {{0.830868, 0.0993805, 0.169132, 0.731488,
   0.258636, 0.910496, 0.990124, 0.890743, 0.731488, 0.089504,
   0.0796275, 0.741364, 1., 0.990124, 0.830868, 0.179008, 0.721611,
   0.179008, 1., 0.910496, 0.820992, 0.00987648, 0.65186, 0.188884,
   1., 0.990124, 0.90062, 0.820992, 0.019753, 0.751241, 0.990124,
   0.268512, 0.671613, 0.0993805, 0.0993805, 0.188884}, {0.75, 0., 0.,
	0.25, 0.75, 1., 1., 1., 0.25, 0., 0., 0.25, 1., 1., 1., 0.25,
   0.25, 0., 1., 1., 0.75, 0., 0.25, 0.25, 1., 1., 0.75, 1., 0., 0.75,
	1., 0.75, 0.25, 0., 0., 0.}, {0.850093, 0.149907, 0.149907,
   0.700185, 0.224861, 0.871508, 0.888889, 0.820111, 0.700185,
   0.128492, 0.111111, 0.775139, 1., 0.888889, 0.850093, 0.179889,
   0.550278, 0.179889, 1., 0.871508, 0.820111, 0.111111, 0.550278,
   0.224861, 1., 0.888889, 0.850093, 0.820111, 0.128492, 0.820111,
   0.888889, 0.299815, 0.775139, 0.149907, 0.149907, 0.224861}, {1.,
   0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0.,
	1., 1., 1., 0., 0., 1., 1., 1., 1., 1., 0., 1., 1., 1., 0., 0.,
   0., 1.}, {1., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1.,
   1., 0., 0., 0., 1., 1., 1., 0., 0., 1., 1., 1., 1., 1., 0., 1., 1.,
	1., 0., 0., 0., 1.}}, {{0.990124, 0.910496, 1., 1., 1., 0.920372,
   0.179008, 0.661737, 0.840745, 0.990124, 0.910496, 0.671613,
   0.830868, 0.0993805, 0.741364, 0.328387, 0.169132, 0.169132, 1.,
   0.268512, 0.089504, 0.0796275, 0.65186, 0.179008, 0.990124,
   0.0993805, 0.089504, 0.65186, 0.0993805, 0.661737, 0.268512,
   0.169132, 0.328387, 0.910496, 0.338263, 0.159255}, {1., 1., 1., 1.,
	1., 1., 0., 0.25, 1., 1., 1., 0.25, 1., 0., 0.75, 0.75, 0., 0.25,
   1., 0.75, 0., 0., 0.25, 0.25, 1., 0., 0., 0.25, 0., 0.25, 0.75, 0.,
	0.75, 1., 0.75, 0.}, {0.908542, 0.895476, 1., 1., 1., 0.908542,
   0.146333, 0.756111, 0.895476, 0.908542, 0.895476, 0.817083,
   0.878056, 0.121944, 0.817083, 0.182917, 0.121944, 0.121944, 1.,
   0.243889, 0.104524, 0.0914583, 0.634167, 0.146333, 0.908542,
   0.121944, 0.104524, 0.634167, 0.121944, 0.756111, 0.243889,
   0.121944, 0.182917, 0.895476, 0.243889, 0.104524}, {1., 1., 1., 1.,
	1., 1., 0., 0., 1., 1., 1., 0., 1., 0., 0., 1., 0., 0., 1., 1.,
   0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 1., 1., 1.,
   0.}, {1., 1., 1., 1., 1., 1., 0., 0., 1., 1., 1., 0., 1., 0., 0.,
   1., 0., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0.,
	1., 1., 1., 0.}}, {{1., 0.920372, 1., 1., 1., 0.910496, 0.188884,
   0.671613, 0.830868, 0.980247, 0.188884, 0.661737, 0.90062,
   0.169132, 0.089504, 0.238883, 0.089504, 0.0993805, 0.980247,
   0.328387, 0.089504, 0.00987648, 0.65186, 0.258636, 0.90062,
   0.169132, 0.169132, 0.179008, 0.830868, 0.990124, 0.188884,
   0.089504, 0.328387, 0.990124, 1., 1.}, {1., 1., 1., 1., 1., 1., 0.,
	0.25, 1., 1., 0.75, 0.25, 1., 0.25, 0., 0.25, 0., 0., 1., 0.75,
   0., 0., 0.25, 0.25, 1., 0., 0.25, 0.25, 1., 1., 0., 0., 0.75, 1.,
   1., 1.}, {1., 0.922778, 1., 1., 1., 0.911746, 0.154444, 0.845556,
   0.897037, 0.911746, 0.154444, 0.794074, 0.897037, 0.102963,
   0.088254, 0.102963, 0.088254, 0.102963, 0.911746, 0.154444,
   0.088254, 0.0772222, 0.691111, 0.154444, 0.897037, 0.102963,
   0.102963, 0.123556, 0.897037, 0.922778, 0.154444, 0.088254,
   0.154444, 0.922778, 1., 1.}, {1., 1., 1., 1., 1., 1., 1., 0., 1.,
   1., 1., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 0.,
	0., 0., 1., 1., 1., 0., 1., 1., 1., 1.}, {1., 1., 1., 1., 1., 1.,
   1., 0., 1., 1., 1., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
	1., 1., 0., 0., 0., 1., 1., 1., 0., 1., 1., 1., 1.}}, {{0.358016,
   1., 1., 1., 0.840745, 0.188884, 0.188884, 0.90062, 0.990124,
   0.840745, 0.671613, 0.00987648, 0.0993805, 0.801239, 0.741364,
   0.671613, 0.179008, 0.089504, 0.0993805, 0.801239, 0.65186,
   0.169132, 0.258636, 0.0993805, 0.0993805, 0.721611, 0.159255,
   0.328387, 0.188884, 0.0993805, 0.179008, 0.159255, 0.328387,
   0.990124, 0.278389, 0.0993805}, {0.75, 1., 1., 1., 1., 0.75, 0.,
   1., 1., 1., 0.25, 0., 0., 0.5, 0.75, 0.25, 0.25, 0., 0., 0.5, 0.25,
	0.25, 0.75, 0., 0., 0.25, 0., 0.75, 0.25, 0., 0., 0., 0.75, 1.,
   0.75, 0.}, {0.888889, 1., 1., 1., 0.853889, 0.255694, 0.255694,
   0.829537, 0.888889, 0.853889, 0.744306, 0.111111, 0.170463,
   0.659074, 0.744306, 0.744306, 0.204556, 0.146111, 0.170463,
   0.659074, 0.488611, 0.170463, 0.255694, 0.170463, 0.170463,
   0.488611, 0.146111, 0.255694, 0.255694, 0.170463, 0.204556,
   0.146111, 0.255694, 0.888889, 0.511389, 0.170463}, {1., 1., 1., 1.,
	1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
   0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 1., 1.,
   0.}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0.,
   0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
	1., 1., 1., 0.} } };
	double featuresDoubl[62];
	double max = -1000000;
	int pos;
	int posMax[5];
	double sum = 0;
	double sumAll[trees];
	int ki = 0;
	for (int i = 0; i < 26; i++) {
		for (int j = 0; j < 5; j++) {
			for (int k = 0; k < 62; k++) {
				if (k < 26)
					featuresDoubl[k] = const_list[k];
				else
					featuresDoubl[k] = featureList[i][j][k - 26];
			}
			for (int n = 0; n < trees; n++) {
				double c = counting(func[n], operators, operatorsFeaturesChar, featuresChar, featuresDoubl, depth(func[n], maxDepth));
				if (c > max) {
					pos = n;
					max = c;
				}
			}
			max = -1000000;
			posMax[j] = pos;
		}
		for (int y = 0; y < 5; y++) {
			if (posMax[y] != i)
				ki++;
		}

		for (int yii = 0; yii < ki; yii++) {
			sum = sum + pow(a, b * yii);
		}
		ki = 0;
		sumAll[i] = sum;
		sum = 0;
	}
	for (int i = 0; i < trees; i++) {
		sum = sum + sumAll[i];
	}

	return sum;
}


double counting(list_node* root, char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], double featuresDoubl[62], int pp) {

	list_node** links;
	links = (list_node*)malloc(pp * sizeof(list_node));
	links[0] = root;
	list_node* current = root;

	int n = 0;
	double a;
	double b;
	if (root->rt == 1) {
		while (root->rt != 0) {
			if (in_massiv(current->left->op) && current->left->rt != 0) {
				n++;
				links[n] = current->left;
				current = current->left;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 0) {
				n++;
				links[n] = current->right;
				current = current->right;
			}

			else if (current->left->rt == 0 && current->right->rt == 0) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->left->pa->values;
				b = current->right->pa->values;
				current->pa->values = count(current, a, b);
				current->rt = 0;
				n--;
				current = links[n];
			}

			else if (current->left->rt == 0 && !in_massiv(current->right->op)) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->left->pa->values;
				b = featuresDoubl[atoi(current->right->op)];
				current->pa->values = count(current, a, b);
				current->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 0) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->right->pa->values;
				b = featuresDoubl[atoi(current->left->op)];
				current->pa->values = count(current, a, b);
				current->rt = 0;
				current->left->rt = 0;
				current = links[n - 1];
				n--;
			}

			else {
				a = featuresDoubl[atoi(current->left->op)];
				b = featuresDoubl[atoi(current->right->op)];
				current->pa = malloc(sizeof(list_node_values));
				current->pa->values = count(current, a, b);
				current->rt = 0;
				current->left->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				n--;

			}

		}
	}
	else {
		while (root->rt != 1) {
			if (in_massiv(current->left->op) && current->left->rt != 1) {
				n++;
				links[n] = current->left;
				current = current->left;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 1) {
				n++;
				links[n] = current->right;
				current = current->right;
			}

			else if (current->left->rt == 1 && current->right->rt == 1) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->left->pa->values;
				b = current->right->pa->values;
				current->pa->values = count(current, a, b);
				current->rt = 1;
				n--;
				current = links[n];
			}

			else if (current->left->rt == 1 && !in_massiv(current->right->op)) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->left->pa->values;
				b = featuresDoubl[atoi(current->right->op)];
				current->pa->values = count(current, a, b);
				current->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 1) {
				current->pa = malloc(sizeof(list_node_values));
				a = current->right->pa->values;
				b = featuresDoubl[atoi(current->left->op)];
				current->pa->values = count(current, a, b);
				current->rt = 1;
				current->left->rt = 1;
				current = links[n - 1];
				n--;
			}

			else {
				a = featuresDoubl[atoi(current->left->op)];
				b = featuresDoubl[atoi(current->right->op)];
				current->pa = malloc(sizeof(list_node_values));
				current->pa->values = count(current, a, b);
				current->rt = 1;
				current->left->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				n--;

			}

		}
	}
	return root->pa->values;
}

int countOper(list_node* root) {
	int pp = depth(root, maxDepth);
	list_node** links;
	links = (list_node*)malloc(pp * sizeof(list_node));
	links[0] = root;
	list_node* current = root;
	int k = 1;
	int n = 0;
	if (root->rt == 1) {
		while (root->rt != 0) {
			if (in_massiv(current->left->op) && current->left->rt != 0) {
				n++;
				links[n] = current->left;
				current = current->left;
				k++;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 0) {
				n++;
				links[n] = current->right;
				current = current->right;
				k++;
			}

			else if (current->left->rt == 0 && current->right->rt == 0) {
				current->rt = 0;
				n--;
				current = links[n];
			}

			else if (current->left->rt == 0 && !in_massiv(current->right->op)) {
				current->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 0) {
				current->rt = 0;
				current->left->rt = 0;
				current = links[n - 1];
				n--;
			}

			else {
				current->rt = 0;
				current->left->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				n--;

			}

		}
	}
	else {
		while (root->rt != 1) {
			if (in_massiv(current->left->op) && current->left->rt != 1) {
				n++;
				links[n] = current->left;
				current = current->left;
				k++;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 1) {
				n++;
				links[n] = current->right;
				current = current->right;
				k++;
			}

			else if (current->left->rt == 1 && current->right->rt == 1) {
				current->rt = 1;
				n--;
				current = links[n];
			}

			else if (current->left->rt == 1 && !in_massiv(current->right->op)) {
				current->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 1) {
				current->rt = 1;
				current->left->rt = 1;
				current = links[n - 1];
				n--;
			}

			else {
				current->rt = 1;
				current->left->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				n--;

			}

		}
	}
	return k;
}
int depth(list_node* root, int pp) {
	list_node** links;
	links = (list_node*)malloc(pp * sizeof(list_node));
	links[0] = root;
	list_node* current = root;
	int k = 1;
	int y = 0;
	int n = 0;
	if (root->rt == 1) {
		while (root->rt != 0) {
			if (in_massiv(current->left->op) && current->left->rt != 0) {
				n++;
				links[n] = current->left;
				current = current->left;
				if (y == 0)
					k++;
				else
					y--;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 0) {
				n++;
				links[n] = current->right;
				current = current->right;
				if (y == 0)
					k++;
				else
					y--;
			}

			else if (current->left->rt == 0 && current->right->rt == 0) {
				current->rt = 0;
				n--;
				y++;
				current = links[n];
			}

			else if (current->left->rt == 0 && !in_massiv(current->right->op)) {
				current->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				y++;
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 0) {
				current->rt = 0;
				current->left->rt = 0;
				current = links[n - 1];
				y++;
				n--;
			}

			else {
				current->rt = 0;
				current->left->rt = 0;
				current->right->rt = 0;
				current = links[n - 1];
				y++;
				n--;

			}

		}
	}
	else {
		while (root->rt != 1) {
			if (in_massiv(current->left->op) && current->left->rt != 1) {
				n++;
				links[n] = current->left;
				current = current->left;
				if (y == 0)
					k++;
				else
					y--;
			}

			else if (in_massiv(current->right->op) && current->right->rt != 1) {
				n++;
				links[n] = current->right;
				current = current->right;
				if (y == 0)
					k++;
				else
					y--;
			}

			else if (current->left->rt == 1 && current->right->rt == 1) {
				current->rt = 1;
				n--;
				y++;
				current = links[n];
			}

			else if (current->left->rt == 1 && !in_massiv(current->right->op)) {
				current->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				y++;
				n--;
			}

			else if (!in_massiv(current->left->op) && current->right->rt == 1) {
				current->rt = 1;
				current->left->rt = 1;
				current = links[n - 1];
				y++;
				n--;
			}

			else {
				current->rt = 1;
				current->left->rt = 1;
				current->right->rt = 1;
				current = links[n - 1];
				y++;
				n--;

			}

		}
	}
	return k;
}



list_node* tree_creation(char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62]) {
	char* oper;
	char* feat;
	char* operFeat;
	list_node* root = malloc(sizeof(list_node));
	list_node* sheel;

	list_node* links[5] = { root };

	oper = operators[rand() % 4];
	root->op = oper;
	root->rt = 1;
	int arg[5][2] = { {1, 1}, {0, 0}, {0, 0}, {0, 0}, {0, 0} };
	int n = 0;
	int k = 1;
	while (k != 0) {
		k = 0;
		int y = rand() % 66;
		operFeat = operatorsFeaturesChar[y];
		if (n != 4) {
			if (y > 3) {
				if (arg[n][0] == 1) {
					add_end(links[n], operFeat, 1);
					arg[n][0] = -1;
				}
				else if (arg[n][1] == 1) {
					add_end(links[n], operFeat, 0);
					arg[n][1] = -1;
				}
				else
					n--;

			}
			else {
				if (arg[n][0] == 1) {
					sheel = add_end(links[n], operFeat, 1);
					links[n + 1] = sheel;
					arg[n][0] = -1;
					arg[n + 1][0] = 1;
					arg[n + 1][1] = 1;
					n++;

				}
				else if (arg[n][1] == 1) {
					sheel = add_end(links[n], operFeat, 0);
					links[n + 1] = sheel;
					arg[n][1] = -1;
					arg[n + 1][0] = 1;
					arg[n + 1][1] = 1;
					n++;
				}
				else
					n--;
			}
		}
		else {

			if (arg[n][0] == 1 && arg[n][1] == 1) {
				feat = featuresChar[(rand() % 62)];
				add_end(links[n], feat, 1);
				feat = featuresChar[(rand() % 62)];
				add_end(links[n], feat, 0);
				arg[n][0] = -1;
				arg[n][1] = -1;
			}
			else if (arg[n][0] == 1 && arg[n][1] == 0) {
				feat = featuresChar[(rand() % 62)];
				add_end(links[n], feat, 0);
				arg[n][1] = -1;
			}
			else if (arg[n][0] == 0 && arg[n][1] == 1) {
				feat = featuresChar[(rand() % 62)];
				add_end(links[n], feat, 1);
				arg[n][0] = -1;
			}
			n--;
		}
		for (int i = 0; i <= n; i++) {
			if (arg[i][0] == 1 || arg[i][1] == 1)
				k++;
		}
	}

	return root;
}


int in_massiv(char* rr) {
	char* operators[4] = { "+", "-", "*", "/" };
	int k = 0;
	for (int i = 0; i < 4; i++) {
		if (operators[i] == rr)
			k = 1;
	}
	return k;
}

double count(list_node* current, double a, double b) {
	if (current->op == "+")
		return a + b;

	if (current->op == "-")
		return a - b;

	if (current->op == "*")
		return a * b;

	if (current->op == "/" && b != 0)
		return a / b;
	else
		return 1;

}


list_node* add_end(list_node* sheet, char* op, int add) {
	list_node* current = sheet;
	if (add == 1) {
		current->left = malloc(sizeof(list_node));
		current->left->op = op;
		current->left->rt = 1;
		current->left->left = NULL;
		return current->left;
	}
	else {
		current->right = malloc(sizeof(list_node));
		current->right->op = op;
		current->right->rt = 1;
		current->right->right = NULL;
		return current->right;
	}
}

void macroMutation(list_node* func[individuals][trees], char* operators[4], char* operatorsFeaturesChar[66], char* featuresChar[62], int probability) {
	for (int i = 0; i < individuals / 2; i++) {
		int a = rand() % 100;
		if (a < probability) {
			func[i][rand() % trees] = tree_creation(operators, operatorsFeaturesChar, featuresChar);
		}
	}

}
